{"title":"Anomaly Detection Demonstrated in the Forest Cover Types Dataset","markdown":{"yaml":{"title":"Anomaly Detection Demonstrated in the Forest Cover Types Dataset","author":"Aruj Nayak","date":"2023-12-06","categories":["Anomaly Detection"],"image":"anomaly.jpg"},"headingText":"Anomaly Detection Demonstrated in the Forest Cover Types Dataset","containsRefs":false,"markdown":"\n\n# Introduction: \nUnderstanding Anomaly Detection is a vital component as it involves identifying patterns or instances that stand out from the majority of data points. Anomalies can signify potential fraud, errors, or abnormal behavior, making their detection critical for decision-making and data quality. In the vast landscape of data, anomalies or outliers can provide crucial insights or indicate potential issues. Thus, this field of Data Analysis specifically focuses on identifying these instances that deviate significantly from the norm within a dataset. This blog post introduces two popular anomaly detection methods: Local Outlier Factor (LOF) and Isolation Forest.\n\n# Local Outlier Factor Anomaly Detection Method: \nLocal Outlier Factor is a robust anomaly detection algorithm, evaluating the local density deviation of individual data points. This method operates by contrasting the density of a specific data point with that of its neighboring points. Instances demonstrating substantially lower density in comparison to their neighbors are assigned higher anomaly scores, signifying their likelihood of being outliers. LOF proves very effective in situations where anomalies are not necessarily far removed from the majority but exhibit a distinctive characteristic of lower density.\n\n# Isolation Forest Anomaly Detection Method: \nIsolation Forest takes a different approach by isolating anomalies rather than profiling normal instances. It constructs a tree-based structure, isolating anomalies in fewer steps due to their uniqueness. Anomalies are isolated more quickly in the tree, making the isolation path shorter. Isolation Forest is efficient, scalable, and often performs well on high-dimensional data.\n\n# Dataset: \nThe Forest Cover Types dataset is commonly used for classification tasks. It comprises of cartographic variables, including topography, soil types, and wilderness areas, to predict forest cover types. In our anomaly detection example, we consider a specific forest cover type as anomalies, aiming to detect unusual instances in the dataset.\n\n```{python}\nimport pandas as pd\nfrom sklearn.datasets import fetch_covtype\nfrom sklearn.ensemble import IsolationForest\nfrom sklearn.neighbors import LocalOutlierFactor\nimport matplotlib.pyplot as plt\nfrom sklearn.decomposition import PCA\n\n# Loading the Forest Cover Types dataset\ncover_types = fetch_covtype()\ndata = pd.DataFrame(data=cover_types.data, columns=[f'feature_{i}' for i in range(cover_types.data.shape[1])])\ndata['target'] = cover_types.target\n```\n\nThe above section involves importing the required python libraries and loading the Forest Cover Types dataset using fetch_covtype. The data is then converted into a Pandas DataFrame for ease of manipulation.\n\nThe following code snippet demonstrates a specific forest cover type (type 1) as anomalies, creating separate datasets for normal and anomaly instances. A combined dataset is then formed for visualization, wich comprises of a subset of normal data and all anomaly data.\n\n```{python}\n# Simplifying by considering one forest cover type (e.g., type 1) as anomalies\n# This can be adjusted based on specific use cases\nanomaly_label = 1\nnormal_data = data[data['target'] != anomaly_label]\nanomaly_data = data[data['target'] == anomaly_label]\n\n# Combining a subset of normal data with anomaly data for visualization\nsubset_normal_data = normal_data.sample(n=1000, random_state=42)\ncombined_data = pd.concat([subset_normal_data, anomaly_data])\n```\n\nNext, Principal Component Analysis (PCA) is applied to reduce dimensionality of this dataset by reducing to two principal components, capturing the most significant variations.\n\n```{python}\n# Employing PCA for dimensionality reduction\npca = PCA(n_components=2)\nX_pca = pca.fit_transform(combined_data.drop('target', axis=1))\n\n```\n\nFinally, the Isolation Forest is employed to visually represent the anomalies in a scatter plot using the reduced PCA space.\n\n```{python}\n# Applying Isolation Forest\nmodel_iforest = IsolationForest(contamination=0.05)\npredictions_iforest = model_iforest.fit_predict(combined_data.drop('target', axis=1))\n# Visualizing Isolation Forest results\nplt.figure(figsize=(12, 6))\nplt.subplot(1, 2, 1)\nplt.scatter(X_pca[:, 0], X_pca[:, 1], c=predictions_iforest, cmap='viridis')\nplt.title('Isolation Forest Anomaly Detection')\nplt.xlabel('Principal Component 1')\nplt.ylabel('Principal Component 2')\n```\n\nAdditionally, a subplot is also created to compare the results obtained using Local Outlier Factor Method to show the difference between these two anomaly detection methods.\n\n``` {python}\n# Implementing Local Outlier Factor (LOF)\nmodel_lof = LocalOutlierFactor(n_neighbors=20, contamination=0.05)\npredictions_lof = model_lof.fit_predict(combined_data.drop('target', axis=1))\n\n# Visualizing Local Outlier Factor results\nplt.subplot(1, 2, 2)\nplt.scatter(X_pca[:, 0], X_pca[:, 1], c=predictions_lof, cmap='viridis')\nplt.title('Local Outlier Factor Anomaly Detection')\nplt.xlabel('Principal Component 1')\nplt.ylabel('Principal Component 2')\nplt.show()\n\n```\n\nThus, anomaly detection proves indispensable in soil microbial analysis and forest coverage assessment, forging a critical link between its importance and the preservation of environmental ecosystems. By pinpointing irregularities in microbial dynamics or unexpected changes in forest vegetation through anomaly detection, we enhance our ability to detect potential threats early on.These methods demonstrate the broader importance of anomaly detection tehcniques in providing actionable insights for environmental conservation and ensuring the long-term health and resilience of ecosystems.\n\n# Source:\n\nImage is taken from- [https://anomify.ai/blogs/what-is-anomaly-detection](https://anomify.ai/blogs/what-is-anomaly-detection)","srcMarkdownNoYaml":"\n# Anomaly Detection Demonstrated in the Forest Cover Types Dataset\n\n# Introduction: \nUnderstanding Anomaly Detection is a vital component as it involves identifying patterns or instances that stand out from the majority of data points. Anomalies can signify potential fraud, errors, or abnormal behavior, making their detection critical for decision-making and data quality. In the vast landscape of data, anomalies or outliers can provide crucial insights or indicate potential issues. Thus, this field of Data Analysis specifically focuses on identifying these instances that deviate significantly from the norm within a dataset. This blog post introduces two popular anomaly detection methods: Local Outlier Factor (LOF) and Isolation Forest.\n\n# Local Outlier Factor Anomaly Detection Method: \nLocal Outlier Factor is a robust anomaly detection algorithm, evaluating the local density deviation of individual data points. This method operates by contrasting the density of a specific data point with that of its neighboring points. Instances demonstrating substantially lower density in comparison to their neighbors are assigned higher anomaly scores, signifying their likelihood of being outliers. LOF proves very effective in situations where anomalies are not necessarily far removed from the majority but exhibit a distinctive characteristic of lower density.\n\n# Isolation Forest Anomaly Detection Method: \nIsolation Forest takes a different approach by isolating anomalies rather than profiling normal instances. It constructs a tree-based structure, isolating anomalies in fewer steps due to their uniqueness. Anomalies are isolated more quickly in the tree, making the isolation path shorter. Isolation Forest is efficient, scalable, and often performs well on high-dimensional data.\n\n# Dataset: \nThe Forest Cover Types dataset is commonly used for classification tasks. It comprises of cartographic variables, including topography, soil types, and wilderness areas, to predict forest cover types. In our anomaly detection example, we consider a specific forest cover type as anomalies, aiming to detect unusual instances in the dataset.\n\n```{python}\nimport pandas as pd\nfrom sklearn.datasets import fetch_covtype\nfrom sklearn.ensemble import IsolationForest\nfrom sklearn.neighbors import LocalOutlierFactor\nimport matplotlib.pyplot as plt\nfrom sklearn.decomposition import PCA\n\n# Loading the Forest Cover Types dataset\ncover_types = fetch_covtype()\ndata = pd.DataFrame(data=cover_types.data, columns=[f'feature_{i}' for i in range(cover_types.data.shape[1])])\ndata['target'] = cover_types.target\n```\n\nThe above section involves importing the required python libraries and loading the Forest Cover Types dataset using fetch_covtype. The data is then converted into a Pandas DataFrame for ease of manipulation.\n\nThe following code snippet demonstrates a specific forest cover type (type 1) as anomalies, creating separate datasets for normal and anomaly instances. A combined dataset is then formed for visualization, wich comprises of a subset of normal data and all anomaly data.\n\n```{python}\n# Simplifying by considering one forest cover type (e.g., type 1) as anomalies\n# This can be adjusted based on specific use cases\nanomaly_label = 1\nnormal_data = data[data['target'] != anomaly_label]\nanomaly_data = data[data['target'] == anomaly_label]\n\n# Combining a subset of normal data with anomaly data for visualization\nsubset_normal_data = normal_data.sample(n=1000, random_state=42)\ncombined_data = pd.concat([subset_normal_data, anomaly_data])\n```\n\nNext, Principal Component Analysis (PCA) is applied to reduce dimensionality of this dataset by reducing to two principal components, capturing the most significant variations.\n\n```{python}\n# Employing PCA for dimensionality reduction\npca = PCA(n_components=2)\nX_pca = pca.fit_transform(combined_data.drop('target', axis=1))\n\n```\n\nFinally, the Isolation Forest is employed to visually represent the anomalies in a scatter plot using the reduced PCA space.\n\n```{python}\n# Applying Isolation Forest\nmodel_iforest = IsolationForest(contamination=0.05)\npredictions_iforest = model_iforest.fit_predict(combined_data.drop('target', axis=1))\n# Visualizing Isolation Forest results\nplt.figure(figsize=(12, 6))\nplt.subplot(1, 2, 1)\nplt.scatter(X_pca[:, 0], X_pca[:, 1], c=predictions_iforest, cmap='viridis')\nplt.title('Isolation Forest Anomaly Detection')\nplt.xlabel('Principal Component 1')\nplt.ylabel('Principal Component 2')\n```\n\nAdditionally, a subplot is also created to compare the results obtained using Local Outlier Factor Method to show the difference between these two anomaly detection methods.\n\n``` {python}\n# Implementing Local Outlier Factor (LOF)\nmodel_lof = LocalOutlierFactor(n_neighbors=20, contamination=0.05)\npredictions_lof = model_lof.fit_predict(combined_data.drop('target', axis=1))\n\n# Visualizing Local Outlier Factor results\nplt.subplot(1, 2, 2)\nplt.scatter(X_pca[:, 0], X_pca[:, 1], c=predictions_lof, cmap='viridis')\nplt.title('Local Outlier Factor Anomaly Detection')\nplt.xlabel('Principal Component 1')\nplt.ylabel('Principal Component 2')\nplt.show()\n\n```\n\nThus, anomaly detection proves indispensable in soil microbial analysis and forest coverage assessment, forging a critical link between its importance and the preservation of environmental ecosystems. By pinpointing irregularities in microbial dynamics or unexpected changes in forest vegetation through anomaly detection, we enhance our ability to detect potential threats early on.These methods demonstrate the broader importance of anomaly detection tehcniques in providing actionable insights for environmental conservation and ensuring the long-term health and resilience of ecosystems.\n\n# Source:\n\nImage is taken from- [https://anomify.ai/blogs/what-is-anomaly-detection](https://anomify.ai/blogs/what-is-anomaly-detection)"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","theme":"cosmo","title-block-banner":true,"title":"Anomaly Detection Demonstrated in the Forest Cover Types Dataset","author":"Aruj Nayak","date":"2023-12-06","categories":["Anomaly Detection"],"image":"anomaly.jpg"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}